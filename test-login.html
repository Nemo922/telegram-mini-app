<!DOCTYPE html>
<html>
<head>
    <title>Login Test</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #1a1a1a; color: #fff; }
        .container { max-width: 500px; margin: 0 auto; }
        input, button { padding: 10px; margin: 10px 0; width: 100%; box-sizing: border-box; }
        button { background: #667eea; color: white; border: none; cursor: pointer; }
        .log { background: #222; padding: 10px; margin: 10px 0; border-radius: 5px; font-size: 12px; max-height: 300px; overflow-y: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” Multi-User Login Test</h1>
        
        <h3>1ï¸âƒ£ KayÄ±t Yap</h3>
        <input type="text" id="regName" placeholder="Ad (Ã¶rn: Ahmet)">
        <input type="text" id="regTelegramId" placeholder="Telegram ID (Ã¶rn: 123456789)">
        <input type="text" id="regUsername" placeholder="Telegram Username (Ã¶rn: ahmet)">
        <button onclick="register()">âœ… KayÄ±t Yap</button>
        
        <h3>2ï¸âƒ£ Ã‡Ä±kÄ±ÅŸ Yap</h3>
        <button onclick="logout()">ğŸšª Ã‡Ä±kÄ±ÅŸ Yap</button>
        
        <h3>3ï¸âƒ£ GiriÅŸ Yap</h3>
        <input type="text" id="loginTelegramId" placeholder="Telegram ID (Ã¶rn: 123456789)">
        <button onclick="login()">ğŸ” GiriÅŸ Yap</button>
        
        <h3>ğŸ“Š Durum</h3>
        <div class="log" id="log"></div>
        
        <h3>ğŸ’¾ localStorage Verileri</h3>
        <button onclick="showStorage()">GÃ¶ster</button>
        <div class="log" id="storage"></div>
    </div>

    <script>
        function log(msg) {
            const logEl = document.getElementById('log');
            logEl.innerHTML += msg + '<br>';
            logEl.scrollTop = logEl.scrollHeight;
        }

        function register() {
            const name = document.getElementById('regName').value;
            const telegramId = document.getElementById('regTelegramId').value;
            const username = document.getElementById('regUsername').value;
            
            if (!name || !telegramId || !username) {
                alert('TÃ¼m alanlarÄ± doldur!');
                return;
            }
            
            try {
                const userId = parseInt(telegramId);
                const userProfile = {
                    userId: userId,
                    firstName: name,
                    telegram: username,
                    telegramId: userId,
                    registeredAt: Date.now()
                };
                
                // userProfile'Ä± kaydet
                localStorage.setItem('userProfile', JSON.stringify(userProfile));
                log(`âœ… userProfile kaydedildi: ${name}`);
                
                // allUsers'a ekle
                let allUsers = JSON.parse(localStorage.getItem('allUsers') || '{}');
                allUsers[userId] = userProfile;
                localStorage.setItem('allUsers', JSON.stringify(allUsers));
                log(`âœ… allUsers kaydedildi. Toplam kullanÄ±cÄ±: ${Object.keys(allUsers).length}`);
                
                showStorage();
            } catch (e) {
                log(`âŒ Hata: ${e.message}`);
            }
        }

        function logout() {
            try {
                localStorage.removeItem('userProfile');
                log('ğŸšª Ã‡Ä±kÄ±ÅŸ yapÄ±ldÄ± - userProfile silindi');
                showStorage();
            } catch (e) {
                log(`âŒ Hata: ${e.message}`);
            }
        }

        function login() {
            const telegramId = document.getElementById('loginTelegramId').value;
            
            if (!telegramId) {
                alert('Telegram ID gir!');
                return;
            }
            
            try {
                const userId = parseInt(telegramId);
                let allUsers = JSON.parse(localStorage.getItem('allUsers') || '{}');
                
                log(`ğŸ” Aranan ID: ${userId}`);
                log(`ğŸ“‹ allUsers iÃ§indeki IDs: ${Object.keys(allUsers).join(', ')}`);
                
                if (allUsers[userId]) {
                    const userProfile = allUsers[userId];
                    localStorage.setItem('userProfile', JSON.stringify(userProfile));
                    log(`âœ… GiriÅŸ baÅŸarÄ±lÄ±! HoÅŸ geldin ${userProfile.firstName}`);
                    showStorage();
                } else {
                    log(`âŒ Bu ID ile kayÄ±tlÄ± hesap bulunamadÄ±!`);
                }
            } catch (e) {
                log(`âŒ Hata: ${e.message}`);
            }
        }

        function showStorage() {
            const storage = document.getElementById('storage');
            const userProfile = localStorage.getItem('userProfile');
            const allUsers = localStorage.getItem('allUsers');
            
            storage.innerHTML = `
                <strong>userProfile:</strong><br>
                ${userProfile ? JSON.stringify(JSON.parse(userProfile), null, 2) : 'BoÅŸ'}<br><br>
                <strong>allUsers:</strong><br>
                ${allUsers ? JSON.stringify(JSON.parse(allUsers), null, 2) : 'BoÅŸ'}
            `;
        }

        // BaÅŸlangÄ±Ã§ta gÃ¶ster
        showStorage();
    </script>
</body>
</html>
